# UNLU STUFF
# Login to foni server and switch to zsh
# alias foni="ssh jamief@foni.uio.no -t '/bin/zsh'"
alias foni="ssh jamief@foni.uio.no -J jamief@login.uio.no -t '/bin/zsh'"
# Mount/unmount remote drive on foni server
# alias foni-mnt="sshfs jamief@foni.uio.no: ~/foni"
alias foni-mnt="sshfs jamief@foni.uio.no: ~/foni -o ssh_command='ssh -J jamief@login.uio.no'"
alias foni-umnt="fusermount3 -u ~/foni"

# Run UNLU pipeline (runs in a subshell so you stay in your current directory
REPOS="$HOME/Dropbox/academic/jobs/oslo-unlu-postdoc/project/git-repos"
GLUE_FOR_UD="$REPOS/glue-for-UD"
PIPELINE_DIR="$REPOS/pipeline"
RULES_FILE="$GLUE_FOR_UD/rules.dat"
CHOP_FILE="$GLUE_FOR_UD/chopRules.dat"
TEMPLATES_FILE="$GLUE_FOR_UD/templates.dat"
DE_TEMPLATES_FILE="$GLUE_FOR_UD/de-templates.dat"

# Without full log info
pipeline() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh $GLUE_FOR_UD/$1 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE 2> $GLUE_FOR_UD/log)
    }
# Only show single proof with fewest DUMMY placeholders
pipeline-min() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -l $GLUE_FOR_UD/$1 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE 2> $GLUE_FOR_UD/log)
    }

# Output to file
pipeline-inspect() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh $GLUE_FOR_UD/$1 $RULES_FILE  $CHOP_FILE $TEMPLATES_FILE 1> $GLUE_FOR_UD/$(basename $1 .conllu).output  2> $GLUE_FOR_UD/log)
}

# Output clause notation rather than DRS
pipeline-clause-min() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -c $GLUE_FOR_UD/$1 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE 2> $GLUE_FOR_UD/log)
    }
# Output clause notation rather than DRS and only show single proof with fewest DUMMY placeholders
pipeline-clause-min() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -lc $GLUE_FOR_UD/$1 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE 2> $GLUE_FOR_UD/log)
    }

# Run via Stanza
pipeline-stanza() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -s$1 $GLUE_FOR_UD/$2 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE 2> $GLUE_FOR_UD/log)
}
# Run via Stanza and only show single proof with fewest DUMMY placeholders
pipeline-stanza-min() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -s$1 -l $GLUE_FOR_UD/$2 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE 2> $GLUE_FOR_UD/log)
}
# Run via Stanza and only show single proof with fewest DUMMY placeholders -- German version -- NEEDS SOMETHING TO BE DONE ABOUT STANZA MODE
pipeline-stanza-min-de() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -s$1 -l $GLUE_FOR_UD/$2 $RULES_FILE $CHOP_FILE $DE_TEMPLATES_FILE 2> $GLUE_FOR_UD/log)
}

# With full log info
pipeline-verbose() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh $GLUE_FOR_UD/$1 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE)
}

# With explanation
pipeline-explain() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -e $GLUE_FOR_UD/$1 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE)
}

# Output to a file called '[...].compare' for comparison
pipeline-compare() {
	(cd $PIPELINE_DIR && ./run_pipeline.sh -o $GLUE_FOR_UD/$1 $RULES_FILE $CHOP_FILE $TEMPLATES_FILE 1> $GLUE_FOR_UD/$(basename $1 .conllu).compare 2> /dev/null)
}

# Clean up generated files
pipeline-clean() {
	{ rm output log 
	rm *.output } 2>/dev/null
}

# Compare results
compare-results() {
(cd $PIPELINE_DIR/run && python3 compare_results.py $GLUE_FOR_UD/$1 $GLUE_FOR_UD/test/test.conllu.output >$GLUE_FOR_UD/comparison 2>$GLUE_FOR_UD/log)
}
